<%= content_for :departments_dropdown do %>
  <div class="list-department">
    <select name="department_name" class="department-selection" form='nav-filter-form'>
      <% if params[:department_name].blank? %>
        <option selected value disabled>Choose a department</option>
      <% else %>
        <option value disabled>Choose a department</option>
      <% end %>
      <% all_departments_names.each do |name|%>
        <%if params[:department_name] == name %>
          <option selected value=<%= name %>> <%= name%> </option>
        <% else %>
          <option value=<%= name%>> <%= name%></option> %>
        <% end %>
      <% end %>
    </select>
  </div>
<% end %>

<%= content_for :development_metrics_sidebar do %>
  <%=  render 'development_metrics/sidebar'%>
<% end %>

<div class="container-fluid">
  <div class="row">
      <div class="metrics-container col-md-12">
        <div class="row">
          <div class="col-md-12">
            <%= render 'shared/department/nav-filter' do |f|%>
              <div class="row">
                <div class="col-md-5 period-input">
                  <%= render 'shared/interval-filter', form: f %>
                </div>
                <div class="col-md-7">
                </div>
              </div>
            <% end %>
          </div>
        </div>
        <% if @overview %>
          <div class="row">
            <%= render 'development_metrics/department_overview', overview: @overview %>
          </div>
        <% end %>
        <div class="row">
          <%= render 'development_metrics/code_climate/code_climate_department_summary',
          department: @department, code_climate: @code_climate %>
        </div>
        <% if @review_turnaround && @merge_time %>
          <div class="row">
            <div class="metrics">
              <div class="graph">
                <%= render 'development_metrics/review_turnaround/main_metric', review_turnaround: @review_turnaround %>
              </div>
              <div class="graph details">
                <%= render 'development_metrics/review_turnaround/details_metric', review_turnaround: @review_turnaround %>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="metrics">
              <div class="graph">
                <%= render 'development_metrics/merge_time/main_metric', merge_time: @merge_time %>
              </div>
              <div class="graph details">
                <div class="distribution-report-button mr-5 mb-2">
                  <%= link_to 'See report',
                              department_pull_requests_path(params[:department_name], { metric: { period: params&.dig(:metric, :period) } }),
                              class: 'btn btn-secondary'
                  %>
                </div>
              </div>
            </div>
          </div>
        <% else %>
          <div class="row">
            <div class="body-empty-container col-md-12 d-flex justify-content-center align-items-center">
              <span>Please select a department to see its metrics</span>
            </div>
          </div>
        <% end %>
      </div>
  </div>
</div>
